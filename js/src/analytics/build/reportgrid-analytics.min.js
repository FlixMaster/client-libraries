(function(){function b(a){if(typeof a==="function")throw"SwfStore Error: Functions cannot be used as keys or values.";}var g=0,e=/[^a-z0-9_]/ig;window.SwfStore=function(a){function b(c){var d=document.createElement("div");document.body.appendChild(d);d.id="SwfStore_"+a.namespace+"_"+g++;if(!c)d.style.position="absolute",d.style.top="-2000px",d.style.left="-2000px";return d}var a=a||{},k={swf_url:"storage.swf",namespace:"swfstore",debug:!1,timeout:10,onready:null,onerror:null},h;for(h in k)k.hasOwnProperty(h)&&
(a.hasOwnProperty(h)||(a[h]=k[h]));a.namespace=a.namespace.replace(e,"_");if(window.SwfStore[a.namespace])throw"There is already an instance of SwfStore using the '"+a.namespace+"' namespace. Use that instance or specify an alternate namespace in the config.";this.config=a;if(a.debug){if(typeof console==="undefined"){var c=b(!0);window.console={log:function(a){var e=b(!0);e.innerHTML=a;c.appendChild(e)}}}this.log=function(b,c,d){c=c==="swfStore"?"swf":c;if(typeof console[b]!=="undefined")console[b]("SwfStore - "+
a.namespace+" ("+c+"): "+d);else console.log("SwfStore - "+a.namespace+": "+b+" ("+c+"): "+d)}}else this.log=function(){};this.log("info","js","Initializing...");SwfStore[a.namespace]=this;k=b(a.debug);h="SwfStore_"+a.namespace+"_"+g++;var m="logfn=SwfStore."+a.namespace+".log&amp;onload=SwfStore."+a.namespace+".onload&amp;onerror=SwfStore."+a.namespace+".onerror&amp;LSOName="+a.namespace;k.innerHTML='<object height="100" width="500" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+
h+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">\t<param value="'+a.swf_url+'" name="movie">\t<param value="'+m+'" name="FlashVars">\t<param value="always" name="allowScriptAccess">\t<embed height="375" align="middle" width="500" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+m+'" type="application/x-shockwave-flash" allowscriptaccess="always" quality="high" loop="false" play="true" name="'+h+'" bgcolor="#ffffff" src="'+a.swf_url+'"></object>';this.swf=document[h]||
window[h];this._timeout=setTimeout(function(){SwfStore[a.namespace].log("error","js","Timeout reached, assuming "+a.swf_url+" failed to load and firing the onerror callback.");if(a.onerror)a.onerror()},a.timeout*1E3)};SwfStore.prototype={version:"1.5",ready:!1,set:function(a,d){this._checkReady();b(a);b(d);this.swf.set(a,d)},get:function(a){this._checkReady();b(a);return this.swf.get(a)},getAll:function(){this._checkReady();var a=this.swf.getAll();a.__flashBugFix&&delete a.__flashBugFix;return a},
clear:function(a){this._checkReady();b(a);this.swf.clear(a)},_checkReady:function(){if(!this.ready)throw"SwfStore is not yet finished initializing. Pass a config.onready callback or wait until this.ready is true before trying to use a SwfStore instance.";},onload:function(){var a=this;setTimeout(function(){clearTimeout(a._timeout);a.ready=!0;a.set("__flashBugFix","1");if(a.config.onready)a.config.onready()},0)},onerror:function(){clearTimeout(this._timeout);if(this.config.onerror)this.config.onerror()}}})();
(function(b){var g={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(b){for(var a=0;a<b.length;a++){var d=b[a].string,g=b[a].prop;this.versionSearchString=b[a].versionSearch||b[a].identity;if(d){if(d.indexOf(b[a].subString)!=-1)return b[a].identity}else if(g)return b[a].identity}},
searchVersion:function(b){var a=b.indexOf(this.versionSearchString);return a==-1?void 0:parseFloat(b.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},
{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",
versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.appVersion,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};g.init();b.client={os:g.OS,browser:g.browser,version:g.version}})(jQuery);
(function(b){var g=+new Date,e=function(a,b){var c=a.exec(b);return c&&c[1]},a=function(a,b){return Math.round(a/b)*b},d=function(){for(var a={pageEngagement:/^queueing|polling|none$/,cookieNamespace:/^\w+$/,attentionResolution:/[1-9]\d*/,crossdomain:/^true|false$/,interaction:/^true|false$/,attention:/^true|false$/,scrolling:/^true|false$/},c=b("script").eq(-1).attr("src").replace(/^.*\?/,"").split(/&/),d=null,i={},g=function(a){return a==="false"?!1:a==+a?+a:a},f=0,h=c.length;f<h;++f)i[(d=c[f].split(/=/))[0]]=
g(d.slice(1).join("="));for(var e in i)if(a.hasOwnProperty(e)&&i.hasOwnProperty(e)&&!a[e].test(i[e]))throw Error('Invalid parameter for option "'+e+'": '+i[e]);return b.extend({},{pageEngagement:"queueing",cookieNamespace:"all",attentionResolution:10,crossdomain:!0,interaction:!1,attention:!1,scrolling:!1,rollup:!0,rollupName:"@all",attentionSelector:"body"},i)}(),k=ReportGrid.normalizePath=function(a){return"/"+/^(?:(?:file|https?):\/\/)?(?:www\.)?([^\?#]+)/i.exec(a)[1]},h=k(document.location.href),
c=function(a,b){var c=function(a){a.setDate(a.getDate()+36500);return a}(new Date);if(arguments.length<=1)return e(RegExp("\\b"+a+"=([^;]*)"),document.cookie);document.cookie=a+"="+b+"; expires="+c.toUTCString();return b},m=b.client.browser+" "+b.client.version,n=b.client.os,x=/iphone/i.test(n)||/android/i.test(n)?"mobile":"standard",y=!!document.referrer&&k(document.referrer),z=/^http:\/\/www\.google\.com/.test(document.referrer)&&decodeURIComponent(e(/[\?&]q=([^&]*)/,document.referrer))||/^http:\/\/search\.yahoo\.com/.test(document.referrer)&&
decodeURIComponent(e(/[\?&]p=([^&]*)/,document.referrer)).replace(/\+/g," ")||/^http:\/\/www\.bing\.com/.test(document.referrer)&&decodeURIComponent(e(/[\?&]q=([^&]*)/,document.referrer)).replace(/\+/g," ")||"",A=(new Date).getHours()-(new Date).getUTCHours(),p=function(a){if(a.attr("id"))return"#"+a.attr("id");for(var b=a[0].nodeName.toLowerCase(),a=a[0].className.split(/\s+/),c=0,d=a.length;c<d;++c)a[c]&&(b+="."+a[c]);return b},f=ReportGrid.customEvent=function(c,f,e){var i={},j=e&&e.path||h;e&&
delete e.path;i[c]=b.extend({},{browserVersion:m,operatingSystem:n,platform:x,totalVisits:v,totalInteraction:s,totalEngagement:a(t+(+new Date-g),1E3),referrer:y,timeOffset:A,"~keywords":z},f||{});c=[j];if(d.rollup){j=j.split(/\//g);for(j.pop();j.length>0;)c.push("/"+j.join("/")+"/"+d.rollupName),j.pop();c.push("/"+d.rollupName)}for(;0<c.length;)return j=c[0],ReportGrid.track("/"+j,b.extend({},e,{event:i}))},v=0,s=0,t=0;f("visited");var o=function(){if(q){var k=c;c=function(a,b){return arguments.length>
1?(k(a,b),q.set(a,b),b):q.get(a)||k(a)}}var l=function(){for(var a="",b=0;b<32;++b)a+=(Math.random()*16>>>0).toString(16);m=!0;return c("reportgrid_identity",a)},m=!1;c("reportgrid_identity")||l();l=function(){var a=+new Date-function(){var a=c("reportgrid_last_visit")||+new Date;c("reportgrid_last_visit",+new Date);return a}();return a>2592E6?"yearly":a>6048E5?"monthly":a>864E5?"weekly":a>1E3?"hourly":"new"}();v+=c("reportgrid_total_visits",(+c("reportgrid_total_visits")||0)+1);t+=+c("reportgrid_total_engagement")||
0;m?f("uniqueVisited"):f("repeatVisited",{timeFrame:l});b(function(){f("loaded",{delay:a(+new Date-g,50)})});e(/https?:\/\/([^\/]+)\//,document.referrer)===(document.location.host||document.location.hostname)?+c("reportgrid_already_unbounced")||(l=+c("reportgrid_bounce_time"),c("reportgrid_already_unbounced",1),f("bounce",{},{path:c("reportgrid_bounce_path"),count:-1,timestamp:new Date(l)})):(c("reportgrid_already_unbounced",0),l=+new Date,c("reportgrid_bounce_path",h),c("reportgrid_bounce_time",
l),f("bounce",{},{timestamp:new Date(l)}));b('a, button, input[type="submit"]').live("click",function(){var a=this.nodeName.toLowerCase();f(a==="a"?"linkClicked":a==="button"?"buttonClicked":a==="input"?"submitClicked":a+"Clicked",{element:p(b(this)),newWindow:b(this).attr("target")==="_blank"})});b("form").live("submit",function(){var a={};b(this).find('select, input[type="checkbox"]').each(function(){a[p(b(this))]=b(this).val()});f("formSubmitted",a)});var i=0;d.scrolling&&setInterval(function(){var a=
b(window).height(),c=b(window).scrollTop(),d=b("body").height(),a=(a+c)/d*10>>>0;a>i&&(f("saw",{region:a}),i=a)},100);b(d.attentionSelector+" *").live("click",function(a){a.target===this&&(++s,d.interaction&&f("interaction",{element:p(b(this)),type:"click"}))});b(d.attentionSelector+" *").live("keypress",function(a){a.target===this&&a.which===13&&(++s,d.interaction&&f("interaction",{element:p(b(this)),type:"enterKey"}))});b('a[href^="mailto:"]').live("click",function(){f("emailed",{address:b(this).attr("href").replace(/^mailto:/,
"")})});d.pageEngagement==="queueing"&&c("reportgrid_page_engagement_time")&&c("reportgrid_page_engagement_last_url")&&f("engagedQueueing",{time:a(+c("reportgrid_page_engagement_time"),2E3)},c("reportgrid_page_engagement_last_url"),new Date(+c("reportgrid_page_last_engagement_start_time")));c("reportgrid_page_engagement_last_url",h);c("reportgrid_page_last_engagement_start_time",+new Date);setInterval(function(){c("reportgrid_page_engagement_time",+new Date-g);c("reportgrid_user_total_engagement",
t+(+new Date-g))},2E3);var j=function(b){setTimeout(function(){f("engagedPolling",{time:a(+new Date-g,1E3)});j(b*2)},b)};d.pageEngagement==="polling"&&j(1E3);if(d.attention){var n=null,o=0,u=0,r=d.attentionResolution,w=1/r;b(d.attentionSelector+" *").live("mousemove",function(c){if(this===c.target){var d=b(this).offset(),e=c.pageY-d.top,c=a((c.pageX-d.left)/b(this).width(),w)*r>>>0,e=a(e/b(this).height(),w)*r>>>0;c===o&&e===u&&this===n||(n=this,o=c,u=e,f("attention",{element:p(b(this)),tileX:c,tileY:e}))}})}},
q=null;d.crossdomain?b(function(){q=new SwfStore({namespace:d.cookieNamespace,swf_url:"http://api.reportgrid.com/js/storage.swf",onready:o,onerror:function(){q=null;o()}})}):o()})(jQuery);
