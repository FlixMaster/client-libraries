(function(){function b(a){if(typeof a==="function")throw"SwfCookie Error: Functions cannot be used as keys or values.";}var h=0,n=/[^a-z0-9_]/ig;window.SwfCookie=function(a){function b(c){var f=document.createElement("div");document.body.appendChild(f);f.id="SwfCookie_"+a.namespace+"_"+h++;if(!c)f.style.position="absolute",f.style.top="-2000px",f.style.left="-2000px";return f}function m(){i||(i=!0,setTimeout(function(){o.setObject(e);i=!1;e={}},a.batch_delay))}var a=a||{},j={swf_url:"swfcookie.swf",
namespace:"swfcookie",debug:!1,timeout:10,onready:null,onerror:null,batch_requests:!0,batch_delay:500},c;for(c in j)j.hasOwnProperty(c)&&(a.hasOwnProperty(c)||(a[c]=j[c]));a.namespace=a.namespace.replace(n,"_");if(window.SwfCookie[a.namespace])throw"There is already an instance of SwfCookie using the '"+a.namespace+"' namespace. Use that instance or specify an alternate namespace in the config.";this.config=a;if(a.debug){if(typeof console==="undefined"){var p=b(!0);window.console={log:function(a){var c=
b(!0);c.innerHTML=a;p.appendChild(c)}}}this.log=function(b,c,d){c=c==="swfCookie"?"swf":c;if(typeof console[b]!=="undefined")console[b]("SwfCookie - "+a.namespace+" ("+c+"): "+d);else console.log("SwfCookie - "+a.namespace+": "+b+" ("+c+"): "+d)}}else this.log=function(){};this.log("info","js","Initializing...");SwfCookie[a.namespace]=this;j=b(a.debug);c="SwfCookie_"+a.namespace+"_"+h++;var k="logfn=SwfCookie."+a.namespace+".log&amp;onload=SwfCookie."+a.namespace+".onload&amp;onerror=SwfCookie."+
a.namespace+".onerror&amp;LSOName="+a.namespace;j.innerHTML='<object height="100" width="500" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+c+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">\t<param value="'+a.swf_url+'" name="movie">\t<param value="'+k+'" name="FlashVars">\t<param value="always" name="allowScriptAccess">\t<embed height="375" align="middle" width="500" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+k+'" type="application/x-shockwave-flash" allowscriptaccess="always" quality="high" loop="false" play="true" name="'+
c+'" bgcolor="#ffffff" src="'+a.swf_url+'"></object>';var o=this.swf=document[c]||window[c],e={},i=!1;this.batchSet=function(a,b){e[a]=b;m()};this.batchSetObject=function(a){for(var b in a)a.hasOwnProperty(b)&&(e[b]=a[b]);m()};this.batchGet=function(a){return e.hasOwnProperty(a)?e[a]:this.swf.get(a)};this.batchGetAll=function(a){for(var b in e)e.hasOwnProperty(b)&&(a[b]=e[b]);return a};this.batchRemove=function(a){delete e[a]};this.batchClear=function(){e={}};this._timeout=setTimeout(function(){SwfCookie[a.namespace].log("error",
"js","Timeout reached, assuming "+a.swf_url+" failed to load and firing the onerror callback.");if(a.onerror)a.onerror()},a.timeout*1E3)};SwfCookie.prototype={version:"1.5",ready:!1,set:function(a,d){this._checkReady();b(a);b(d);this.config.batch_requests?this.batchSet(a,d):this.swf.set(a,d)},setObject:function(a){this._checkReady();b(a);this.config.batch_requests?this.batchSetObject(a):this.swf.setObject(a)},get:function(a){this._checkReady();b(a);if(this.config.batch_requests){var d=this.batchGet(a);
if(null!=d)return d}return this.swf.get(a)},getAll:function(){this._checkReady();var a=this.swf.getAll();a.__flashBugFix&&delete a.__flashBugFix;return this.config.batch_requests?this.batchGetAll(a):a},remove:function(a){this._checkReady();b(a);this.config.batch_requests&&this.batchRemove(a);this.swf.remove(a)},clear:function(){this._checkReady();this.config.batch_requests&&this.batchClear();this.swf.clear()},_checkReady:function(){if(!this.ready)throw"SwfCookie is not yet finished initializing. Pass a config.onready callback or wait until this.ready is true before trying to use a SwfCookie instance.";
},onload:function(){var a=this;setTimeout(function(){clearTimeout(a._timeout);a.ready=!0;a.set("__flashBugFix","1");if(a.config.onready)a.config.onready()},0)},onerror:function(){clearTimeout(this._timeout);if(this.config.onerror)this.config.onerror()}}})();
(function(b){var h={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(b){for(var a=0;a<b.length;a++){var d=b[a].string,h=b[a].prop;this.versionSearchString=b[a].versionSearch||b[a].identity;if(d){if(d.indexOf(b[a].subString)!=-1)return b[a].identity}else if(h)return b[a].identity}},
searchVersion:function(b){var a=b.indexOf(this.versionSearchString);return a==-1?void 0:parseFloat(b.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},
{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",
versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.appVersion,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};h.init();b.client={os:h.OS,browser:h.browser,version:h.version}})(jQuery);
(function(b){var h=+new Date,n=function(a,b){var c=a.exec(b);return c&&c[1]},a=function(a,b){return Math.round(a/b)*b},d=function(){for(var a={pageEngagement:/^queueing|polling|none$/,cookieNamespace:/^\w+$/,attentionResolution:/[1-9]\d*/,crossdomain:/^true|false$/,interaction:/^true|false$/,attention:/^true|false$/,scrolling:/^true|false$/,rollup:/^all|domain|global|domainglobal|false$/},c=b("script").eq(-1).attr("src").replace(/^.*\?/,"").split(/&/),d=null,l={},h=function(a){return a==="false"?
!1:a==+a?+a:a},e=0,g=c.length;e<g;++e)l[(d=c[e].split(/=/))[0]]=h(d.slice(1).join("="));for(var f in l)if(a.hasOwnProperty(f)&&l.hasOwnProperty(f)&&!a[f].test(l[f]))throw Error('Invalid parameter for option "'+f+'": '+l[f]);return b.extend({},{pageEngagement:"queueing",cookieNamespace:"all",attentionResolution:10,crossdomain:!0,interaction:!1,attention:!1,scrolling:!1,rollup:"domain",rollupName:"__all",attentionSelector:"body"},l)}(),m=ReportGrid.normalizePath=function(a){return"/"+/^(?:(?:file|https?):\/\/)?(?:www\.)?([^\?#]+)/i.exec(a)[1]},
j=m(document.location.href),c=function(a,b){var c=function(a){a.setDate(a.getDate()+36500);return a}(new Date);if(arguments.length<=1)return n(RegExp("\\b"+a+"=([^;]*)"),document.cookie);document.cookie=a+"="+b+"; expires="+c.toUTCString();return b},p=b.client.browser+" "+b.client.version,k=b.client.os,o=/iphone/i.test(k)||/android/i.test(k)?"mobile":"standard";document.referrer&&m(document.referrer);/^http:\/\/www\.google\.com/.test(document.referrer)&&decodeURIComponent(n(/[\?&]q=([^&]*)/,document.referrer))||
/^http:\/\/search\.yahoo\.com/.test(document.referrer)&&decodeURIComponent(n(/[\?&]p=([^&]*)/,document.referrer)).replace(/\+/g," ")||/^http:\/\/www\.bing\.com/.test(document.referrer)&&decodeURIComponent(n(/[\?&]q=([^&]*)/,document.referrer)).replace(/\+/g," ");var e=(new Date).getHours()-(new Date).getUTCHours(),i=function(a){if(a.attr("id"))return"#"+a.attr("id");for(var b=a[0].nodeName.toLowerCase(),a=a[0].className.split(/\s+/),c=0,d=a.length;c<d;++c)a[c]&&(b+="."+a[c]);return b},x=function(b){for(var c=
{browserVersion:p,operatingSystem:k,platform:o,totalVisits:v,totalInteraction:t,totalEngagement:a(u+(+new Date-h),1E3),timeOffset:e},b=b||[],d=0;d<b.length;d++)delete c[b[d]];return c},f=function(a){return(a=a.match(/^\/+([^\/]+)\//))?a[1]:null},g=ReportGrid.customEvent=function(a,c,e){var h={},g=e&&e.path||j;e&&delete e.path;h[a]=b.extend({},x(e&&e.remove),c||{});a=[g];if(d.rollup){var i;switch(d.rollup){case "domain":(i=f(g))&&a.push(i+"/"+d.rollupName);break;case "global":a.push("/"+d.rollupName);
break;case "domainglobal":(i=f(g))&&a.push(i+"/"+d.rollupName);a.push("/"+d.rollupName);break;case "all":g=g.split(/\//g);for(g.pop();g.length>0;)a.push(g.join("/")+"/"+d.rollupName),g.pop()}}return ReportGrid.track(a,b.extend({},e,{event:h}))},v=0,t=0,u=0;g("visited",null,{remove:["totalInteraction"]});var q=function(){if(r){var e=c;c=function(a,b){return arguments.length>1?(e(a,b),r.set(a,b),b):r.get(a)||e(a)}}var f=function(){for(var a="",b=0;b<32;++b)a+=(Math.random()*16>>>0).toString(16);k=!0;
return c("reportgrid_identity",a)},k=!1;c("reportgrid_identity")||f();f=function(){var a=+new Date-function(){var a=c("reportgrid_last_visit")||+new Date;c("reportgrid_last_visit",+new Date);return a}();return a>2592E6?"yearly":a>6048E5?"monthly":a>864E5?"weekly":a>1E3?"hourly":"new"}();v+=c("reportgrid_total_visits",(+c("reportgrid_total_visits")||0)+1);u+=+c("reportgrid_total_engagement")||0;k?g("uniqueVisited",null,{remove:["totalInteraction"]}):g("repeatVisited",{timeFrame:f},{remove:["totalInteraction"]});
n(/https?:\/\/([^\/]+)\//,document.referrer)===(document.location.host||document.location.hostname)?+c("reportgrid_already_unbounced")||(f=+c("reportgrid_bounce_time"),c("reportgrid_already_unbounced",1),g("bounce",{count:-1,timestamp:f},{path:c("reportgrid_bounce_path")})):(c("reportgrid_already_unbounced",0),f=+new Date,c("reportgrid_bounce_path",j),c("reportgrid_bounce_time",f),g("bounce",{timestamp:f},{}));b('a, button, input[type="submit"]').live("click",function(){var a=this.nodeName.toLowerCase();
g(a==="a"?"linkClicked":a==="button"?"buttonClicked":a==="input"?"submitClicked":a+"Clicked",{element:i(b(this)),newWindow:b(this).attr("target")==="_blank"})});b("form").live("submit",function(){var a={};b(this).find('select, input[type="checkbox"]').each(function(){a[i(b(this))]=b(this).val()});g("formSubmitted",a)});var l=0;d.scrolling&&setInterval(function(){var a=b(window).height(),c=b(window).scrollTop(),d=b("body").height(),a=(a+c)/d*10>>>0;a>l&&(g("saw",{region:a}),l=a)},100);b("*").live("click",
function(a){a.target===this&&(++t,d.interaction&&g("interaction",{element:i(b(this)),type:"click"}))});b("*").live("keypress",function(a){a.target===this&&a.which===13&&(++t,d.interaction&&g("interaction",{element:i(b(this)),type:"enterKey"}))});b('a[href^="mailto:"]').live("click",function(){g("emailed",{address:b(this).attr("href").replace(/^mailto:/,"")})});d.pageEngagement==="queueing"&&c("reportgrid_page_engagement_time")&&c("reportgrid_page_engagement_last_url")&&c("reportgrid_page_engagement_last_url",
j);c("reportgrid_page_last_engagement_start_time",+new Date);setInterval(function(){c("reportgrid_page_engagement_time",+new Date-h);c("reportgrid_user_total_engagement",u+(+new Date-h))},100);var m=function(b){setTimeout(function(){g("engagedPolling",{time:a(+new Date-h,1E3)});m(b*2)},b)};d.pageEngagement==="polling"&&m(1E3);if(d.attention){var o=null,p=0,q=0,s=d.attentionResolution,w=1/s;b(d.attentionSelector+" *").live("mousemove",function(c){if(this===c.target){var d=b(this).offset(),e=c.pageY-
d.top,c=a((c.pageX-d.left)/b(this).width(),w)*s>>>0,e=a(e/b(this).height(),w)*s>>>0;c===p&&e===q&&this===o||(o=this,p=c,q=e,g("attention",{element:i(b(this)),tileX:c,tileY:e}))}})}},r=null;d.crossdomain?b(function(){r=new SwfCookie({namespace:d.cookieNamespace,swf_url:"http://api.reportgrid.com/js/swfcookie.swf",onready:q,onerror:function(){r=null;q()}})}):q()})(jQuery);
